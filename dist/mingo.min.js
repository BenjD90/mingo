//! mingo.js 3.0.0
//! Copyright (c) 2020 Francis Asante
//! MIT
!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((n=n||self).mingo={})}(this,function(n){"use strict";function c(n){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function s(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")}function e(n,r){for(var t=0;t<r.length;t++){var e=r[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}function r(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}function u(n,r){return function(n){if(Array.isArray(n))return n}(n)||function(n,r){if(!(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n)))return;var t=[],e=!0,u=!1,i=void 0;try{for(var o,a=n[Symbol.iterator]();!(e=(o=a.next()).done)&&(t.push(o.value),!r||t.length!==r);e=!0);}catch(n){u=!0,i=n}finally{try{e||null==a.return||a.return()}finally{if(u)throw i}}return t}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i="null",o="undefined",a="boolean",f="number",l="string",v="date",h="regexp",p="array",d="object",g="function",y=[i,o,a,f,l,v,h],m="expression",$="group",_="pipeline",b="projection",x="query",O=function(){};Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(n,r){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),e=t.length>>>0;if(0==e)return!1;var u,i,o=0|r,a=Math.max(0<=o?o:e-Math.abs(o),0);for(;a<e;){if((u=t[a])===(i=n)||"number"==typeof u&&"number"==typeof i&&isNaN(u)&&isNaN(i))return!0;a++}return!1}});var k=Array.prototype.push;function A(n,r){n||K(r)}function w(n){switch(E(n)){case p:return n.map(w);case d:return Q(n,w);default:return n}}function j(n){return n instanceof Array?cn([],n):n instanceof Object?Object.assign({},n):n}function M(n){return null===n?"Null":void 0===n?"Undefined":n.constructor.name}function E(n){return M(n).toLowerCase()}function N(n){return c(n)===a}function S(n){return c(n)===l}function P(n){return c(n)===f}var T=Array.isArray||function(n){return n instanceof Array};function I(n){return!!n&&n.constructor===Object}function R(n){return n===Object(n)}function t(n){return E(n)===v}function F(n){return E(n)===h}function C(n){return c(n)===g}function D(n){return null==n}function L(n){return null===n}function q(n){return void 0===n}function U(n,r){return n.includes(r)}function z(n,r){return!U(n,r)}function B(n){return!!n}function Y(n){return D(n)||T(n)&&0===n.length||I(n)&&0===H(n).length||!n}function J(n){return n instanceof Array?n:[n]}function V(n,r){return n.hasOwnProperty(r)}function K(n){throw new Error(n)}var H=Object.keys;function G(n,r){if(n instanceof Array)for(var t=n,e=0,u=t.length;e<u&&!1!==r(t[e],e);e++);else for(var i in n)if(n.hasOwnProperty(i)&&!1===r(n[i],i))break}function Q(n,r){for(var t={},e=H(n),u=0;u<e.length;u++){var i=e[u];t[i]=r(n[i],i)}return t}function W(r,t,e){if(r===O)return t;if(t===O)return r;var n=[r,t];if(!n.every(I)&&!n.every(T))throw Error("mismatched types. must both be array or object");if(e.flatten=e.flatten||!1,T(r)){var u=r,i=t;if(e.flatten){for(var o=0,a=0;o<u.length&&a<i.length;)u[o]=W(u[o++],i[a++],e);for(;a<i.length;)u.push(t[a++])}else k.apply(u,i)}else Object.keys(t).forEach(function(n){r.hasOwnProperty(n)?r[n]=W(r[n],t[n],e):r[n]=t[n]});return r}function X(t,e,u){return Array.isArray(t)?t.reduce(e,u):(G(t,function(n,r){return u=e(u,n,r,t)}),u)}function Z(n,r){var t=r.map(un);return n.filter(function(n){return U(t,un(n))})}function nn(n,r){var i=[];return function n(r,t){for(var e=0,u=r.length;e<u;e++)T(r[e])&&(0<t||t<0)?n(r[e],Math.max(-1,t-1)):i.push(r[e])}(n,1<arguments.length&&void 0!==r?r:-1),i}function rn(n,r){for(var t=[n],e=[r];0<t.length;)if((n=t.pop())!==(r=e.pop())){var u=E(n);if(u!==E(r)||u===g)return!1;if(n instanceof Array&&r instanceof Array){if(n.length!==r.length)return!1;cn(t,n),cn(e,r)}else if(n instanceof Object&&r instanceof Object){var i=H(n),o=H(r);if(i.length!==o.length)return!1;i.sort(),o.sort();for(var a=0,s=i.length;a<s;a++){var c=i[a];if(c!==o[a])return!1;t.push(n[c]),e.push(r[c])}}else if(en(n)!==en(r))return!1}return 0===t.length}function tn(n){var t={},e=[];return G(n,function(n){var r=un(n);V(t,r)||(e.push(n),t[r]=0)}),e}function en(r){var n=E(r);switch(n){case a:case f:case h:return r.toString();case l:return JSON.stringify(r);case v:return r.toISOString();case i:case o:return n;case p:return"["+r.map(en)+"]";default:var t=n===d?"":"".concat(M(r)),e=H(r);return e.sort(),"".concat(t,"{")+e.map(function(n){return"".concat(en(n),":").concat(en(r[n]))})+"}"}}function un(n){if(D(n))return null;for(var r=0,t=en(n),e=t.length;e;)r=(r<<5)-r^t.charCodeAt(--e);return r>>>0}function on(n,r){return n<r?-1:r<n?1:0}function an(n,r,t){var e=[],u=[],i=new Object;if(t=t||on,Y(n))return n;for(var o=0;o<n.length;o++){var a=n[o],s=r(a,o);D(s)?u.push(a):(i[s]?i[s].push(a):i[s]=[a],e.push(s))}e.sort(t);for(var c=0;c<e.length;c++)cn(u,i[e[c]]);return u}function sn(n,u){var i={keys:[],groups:[]},o={};return G(n,function(n){var r=u(n),t=un(r),e=-1;void 0===o[t]&&(e=i.keys.length,o[t]=e,i.keys.push(r),i.groups.push([])),e=o[t],i.groups[e].push(n)}),i}function cn(n,r){return k.apply(n,r),n}function fn(u){var i,o=this;return i={},function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=un(r);return V(i,e)||(i[e]=u.apply(o,r)),i[e]}}function ln(n,r){return R(n)?n[r]:void 0}function vn(n,r,t){var o=0;return void 0===t&&(t={preserveMetadata:!1}),n=U(y,E(n))?n:function e(n,u){for(var r=n,t=0;t<u.length;t++){var i=u[t];if(null===i.match(/^\d+$/)&&Array.isArray(r)){if(0===t&&0<o)break;o+=1,u=u.slice(t),r=X(r,function(n,r){var t=e(r,u);return void 0!==t&&n.push(t),n},[]);break}if(void 0===(r=ln(r,i)))break}return r}(n,r.split(".")),!0===t.preserveMetadata?{result:n,depth:o}:n}function hn(n,r,t){void 0===t&&(t={preserveMissingValues:!1});var e,u,i=r.split("."),o=i[0],a=i.slice(1).join("."),s=null!==o.match(/^\d+$/),c=1<i.length;if(n instanceof Array)s?(e=ln(n,Number(o)),c&&(e=hn(e,a,t)),e=[e]):(e=[],G(n,function(n){u=hn(n,r,t),t.preserveMissingValues?(void 0===u&&(u=O),e.push(u)):void 0!==u&&e.push(u)}));else{if(u=ln(n,o),c&&(u=hn(u,a,t)),void 0===u)return;(e={})[o]=u}return e}function pn(n){if(Array.isArray(n))for(var r=n.length-1;0<=r;r--)n[r]===O?n.splice(r,1):pn(n[r]);else if(I(n))for(var t in n)n.hasOwnProperty(t)&&pn(n[t]);return n}function dn(n,r,t,e){var u=r.split("."),i=u[0],o=u.slice(1).join(".");1===u.length?t(n,i):(!0===e&&D(n[i])&&(n[i]={}),dn(n[i],o,t,e))}function gn(n,r,t){dn(n,r,function(n,r){n[r]=t},!0)}function yn(n,r){dn(n,r,function(n,r){n instanceof Array&&/^\d+$/.test(r)?n.splice(parseInt(r),1):I(n)&&delete n[r]})}function mn(n){return!!n&&"$"===n[0]}function $n(n){if(U(y,E(n)))return F(n)?{$regex:n}:{$eq:n};if(n instanceof Object){var r=H(n);if(!r.some(mn))return{$eq:n};if(U(r,"$regex")){var t,e=new RegExp(n.$regex),u=n.$options||"";t=e instanceof RegExp?e.source:e,i={ignoreCase:e.ignoreCase||0<=u.indexOf("i"),multiline:e.multiline||0<=u.indexOf("m"),global:e.global||0<=u.indexOf("g")},o+=i.ignoreCase?"i":"",o+=i.multiline?"m":"",o+=i.global?"g":"",n.$regex=new RegExp(t,u),delete n.$options}}var i,o;return n}function _n(n,r,t){return D(t)?r<0?(r=Math.max(0,n.length+r),t=n.length-r+1):(t=r,r=0):(r<0&&(r=Math.max(0,n.length+r)),A(0<t,"Invalid argument value for $slice operator. Limit must be a positive number"),t+=r),n.slice(r,t)}function bn(n,r){var t=X(n,function(n,r){return n+r},0),e=n.length||1,u=r?1:0,i=t/e;return Math.sqrt(X(n,function(n,r){return n+Math.pow(r-i,2)},0)/(e-u))}function xn(){return Object.assign({computeValue:En,ops:jn},{assert:A,clone:j,cloneDeep:w,each:G,err:K,hashCode:un,getType:M,has:V,includes:U.bind(null),isArray:T,isBoolean:N,isDate:t,isEmpty:Y,isEqual:rn,isFunction:C,isNil:D,isNull:L,isNumber:P,isObject:I,isRegExp:F,isString:S,isUndefined:q,keys:H,reduce:X,resolve:vn,resolveObj:hn})}var On={key:"_id"};var kn={$$ROOT:function(n,r,t){return t.root},$$CURRENT:function(n){return n},$$REMOVE:function(){}},An={$$KEEP:function(n){return n},$$PRUNE:function(){},$$DESCEND:function(t,e,u){return V(e,"$cond")&&G(t,function(n,r){R(n)&&(T(n)?(i=[],G(n,function(n){I(n)&&(n=Nn(n,e,u)),D(n)||i.push(n)})):i=Nn(n,e,u),D(i)?delete t[r]:t[r]=i)}),t;var i}};function wn(){return On.key}function jn(){return X(Array.prototype.slice.call(arguments),function(n,r){return cn(n,H(Gr[r]))},[])}function Mn(t,n,e){if(V(Gr[$],n))return Gr[$][n](t,e);if(I(e)){var u={};return G(e,function(n,r){if(u[r]=Mn(t,r,e[r]),V(Gr[$],r))return u=u[r],A(1===H(e).length,"Invalid $group expression '"+JSON.stringify(e)+"'"),!1}),u}}function En(t,e,n,u){if(void 0===u&&(u={root:t}),V(Gr[m],n))return Gr[m][n](t,e,u);if(V(Gr[$],n))return t=En(t,e,null,u),A(T(t),n+" expression must resolve to an array"),Gr[$][n](t,null,u);if(S(e)&&0<e.length&&"$"===e[0]){if(V(An,e))return e;var r=e.split(".");if(V(kn,r[0])){if(t=kn[r[0]](t,null,u),1==r.length)return t;e=e.substr(r[0].length)}return vn(t,e.slice(1))}if(Array.isArray(e))return e.map(function(n){return En(t,n)});if(E(e)!==d)return e;var i=new Object;return G(e,function(n,r){if(i[r]=En(t,n,r,u),[m,$].some(function(n){return V(Gr[n],r)}))return A(1===H(e).length,"Invalid aggregation expression '"+JSON.stringify(e)+"'"),i=i[r],!1}),i}function Nn(n,r,t){var e=En(n,r,null,t);return V(An,e)?An[e](n,r,t):e}function Sn(n,r,t){var e=Math.abs(n)===n?1:-1;n=Math.abs(n);var u=Math.trunc(n),i=n-u;if(0===r){var o=Math.trunc(10*i);t&&1==(1&u)&&5<=o&&u++}else if(0<r){var a=Math.pow(10,r),s=Math.trunc(i*a),c=Math.trunc(i*a*10)%10;t&&5<c&&(s+=1),u+=s/a}else if(r<0){var f=Math.pow(10,-1*r),l=u%f;if(u=Math.max(0,u-l),t&&-1==e){for(;10<l;)l-=l%10;0<u&&5<=l&&(u+=f)}}return u*e}function Pn(n){return n instanceof Cn?n:new Cn(n)}var Tn,In,Rn=new Error;function Fn(f,l,v){var h=!1,p=-1,d=0;return function(n){try{n:for(;!h;){var r=f();p++;for(var t=-1,e=l.length,u=!1;++t<e;){var i=l[t],o=i.value;switch(i.action){case Tn.MAP:r=o(r,p);break;case Tn.FILTER:if(!o(r,p))continue n;break;case Tn.TAKE:--i.value,i.value||(u=!0);break;case Tn.DROP:--i.value,i.value||(s=t,c=(a=l).slice(s+1),a.splice(s),Array.prototype.push.apply(a,c));continue n;default:break n}}if(h=u,!n)return{value:r,done:!1};v[d++]=r}}catch(n){if(n!==Rn)throw n}var a,s,c;return{done:h=!0}}}(In=Tn=Tn||{})[In.MAP=0]="MAP",In[In.FILTER=1]="FILTER",In[In.TAKE=2]="TAKE",In[In.DROP=3]="DROP";var Cn=function(){function a(n){var r,t;if(s(this,a),this.__iteratees=[],this.__first=!1,this.__done=!1,this.__buf=[],n instanceof Function&&(n={next:n}),(t=n)&&"object"===c(t)&&t.next instanceof Function){var e=n;r=function(){var n=e.next();if(n.done)throw Rn;return n.value}}else if(Array.isArray(n)){var u=n,i=u.length,o=0;r=function(){if(o<i)return u[o++];throw Rn}}else if(!(n instanceof Function))throw new Error("Source is not iterable. Must be Array, Function, or Generator");this.__next=Fn(r,this.__iteratees,this.__buf)}return r(a,[{key:"_validate",value:function(){if(this.__first)throw new Error("Cannot add iteratee/transform after `first()`")}},{key:"_push",value:function(n,r){return this._validate(),this.__iteratees.push({action:n,value:r}),this}},{key:"next",value:function(){return this.__next()}},{key:"map",value:function(n){return this._push(Tn.MAP,n)}},{key:"filter",value:function(n){return this._push(Tn.FILTER,n)}},{key:"take",value:function(n){return 0<n?this._push(Tn.TAKE,n):this}},{key:"drop",value:function(n){return 0<n?this._push(Tn.DROP,n):this}},{key:"transform",value:function(n){this._validate();var r,t=this;return Pn(function(){return(r=r||Pn(n(t.value()))).next()})}},{key:"first",value:function(){return this.take(1),this.__first=!0,this}},{key:"value",value:function(){return this.__done||(this.__done=this.__next(!0).done),this.__first?this.__buf[0]:this.__buf}},{key:"each",value:function(n){for(;;){var r=this.next();if(r.done)break;if(!1===n(r.value))return!1}return!0}},{key:"reduce",value:function(n,r){var t=this.next(),e=0;for(void 0!==r||t.done||(r=t.value,t=this.next(),e++);!t.done;)r=n(r,t.value,e++),t=this.next();return r}},{key:"size",value:function(){return this.reduce(function(n,r){return++n},0)}}]),a}();"function"==typeof Symbol&&(Cn.prototype[Symbol.iterator]=function(){return this});var Dn=function(){function t(n,r){s(this,t),this.__operators=n,this.__options=r}return r(t,[{key:"stream",value:function(n,e){var u=this,i=Pn(n),o=Gr[_];return Y(this.__operators)||G(this.__operators,function(n){var r=H(n),t=r[0];A(1===r.length&&V(Gr[_],t),"invalid aggregation operator ".concat(t)),i=e instanceof Un?o[t].call(e,i,n[t],u.__options):o[t](i,n[t],u.__options)}),i}},{key:"run",value:function(n,r){return this.stream(n,r).value()}}]),t}();function Ln(n,r,t){return A(T(r),"Aggregation pipeline must be an array"),new Dn(r,t).run(n)}var qn=function(){function e(n,r,t){s(this,e),this.__filterFn=r.test.bind(r),this.__query=r,this.__source=n,this.__projection=t||r.__projection,this.__operators=[],this.__result=null,this.__stack=[],this.__options={}}return r(e,[{key:"_fetch",value:function(){return this.__result||(I(this.__projection)&&this.__operators.push({$project:this.__projection}),this.__result=Pn(this.__source).filter(this.__filterFn),0<this.__operators.length&&(this.__result=new Dn(this.__operators,this.__options).stream(this.__result,this.__query))),this.__result}},{key:"all",value:function(){return this._fetch().value()}},{key:"count",value:function(){return this.all().length}},{key:"skip",value:function(n){return this.__operators.push({$skip:n}),this}},{key:"limit",value:function(n){return this.__operators.push({$limit:n}),this}},{key:"sort",value:function(n){return this.__operators.push({$sort:n}),this}},{key:"collation",value:function(n){return this.__options.collation=n,this}},{key:"next",value:function(){if(this.__stack){if(0<this.__stack.length)return this.__stack.pop();var n=this._fetch().next();if(!n.done)return n.value;this.__stack=null}}},{key:"hasNext",value:function(){if(!this.__stack)return!1;if(0<this.__stack.length)return!0;var n=this._fetch().next();return n.done?this.__stack=null:this.__stack.push(n.value),!!this.__stack}},{key:"map",value:function(n){return this._fetch().map(n).value()}},{key:"forEach",value:function(n){this._fetch().each(n)}}]),e}();"function"==typeof Symbol&&(qn.prototype[Symbol.iterator]=function(){return this._fetch()});var Un=function(){function t(n,r){s(this,t),this.__criteria=n,this.__projection=r||{},this.__compiled=[],this._compile()}return r(t,[{key:"_compile",value:function(){var r,e=this;A(I(this.__criteria),"query criteria must be an object"),G(this.__criteria,function(n,t){"$where"===t?r={field:t,expr:n}:"$expr"===t||U(["$and","$or","$nor"],t)?e._processOperator(t,t,n):(A(!mn(t),"unknown top level operator: ".concat(t)),G(n=$n(n),function(n,r){e._processOperator(t,r,n)})),I(r)&&e._processOperator(r.field,r.field,r.expr)})}},{key:"_processOperator",value:function(n,r,t){A(V(Gr[x],r),"invalid query operator ".concat(r," detected")),this.__compiled.push(Gr[x][r](n,t))}},{key:"test",value:function(n){for(var r=0,t=this.__compiled.length;r<t;r++)if(!this.__compiled[r](n))return!1;return!0}},{key:"find",value:function(n,r){return new qn(n,this,r)}},{key:"remove",value:function(n){var t=this;return X(n,function(n,r){return t.test(r)||n.push(r),n},[])}}]),t}();function zn(n,r){if(rn(n,r))return!0;if(D(n)&&D(r))return!0;if(n instanceof Array){var t=rn.bind(null,r);return n.some(t)||nn(n,1).some(t)}return!1}function Bn(n,r){return!zn(n,r)}function Yn(n,r){return D(n)?r.some(L):0<Z(J(n),r).length}function Jn(n,r){return!Yn(n,r)}function Vn(n,r){return Wn(n,r,function(n,r){return n<r})}function Kn(n,r){return Wn(n,r,function(n,r){return n<=r})}function Hn(n,r){return Wn(n,r,function(n,r){return r<n})}function Gn(n,r){return Wn(n,r,function(n,r){return r<=n})}function Qn(n,r){if(0<n.length){var t=function(n){return n},e=r;H(r).every(mn)&&(e={temp:r},t=function(n){return{temp:n}});for(var u=new Un(e),i=0,o=n.length;i<o;i++)if(u.test(t(n[i])))return!0}return!1}function Wn(n,r,t){return J(n).some(function(n){return M(n)===M(r)&&t(n,r)})}function Xn(e){return function(n,r){var t=En(n,r);return e(t[0],t[1])}}var Zn=Xn(zn),nr=Xn(Bn),rr=Xn(Hn),tr=Xn(Vn),er=Xn(Gn),ur=Xn(Kn),ir=Xn(Jn);function or(n,r){var t=En(n,r),e=new Date(t.getFullYear(),0,0),u=t.getTime()-e.getTime();return Math.round(u/864e5)}function ar(n,r){return En(n,r).getDate()}function sr(n,r){return En(n,r).getDay()+1}function cr(n,r){return En(n,r).getFullYear()}function fr(n,r){return En(n,r).getMonth()+1}function lr(n,r){var t=En(n,r);(t=new Date(+t)).setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7));var e=new Date(t.getFullYear(),0,1);return Math.floor(((t.getTime()-e.getTime())/864e5+1)/7)}function vr(n,r){return En(n,r).getUTCHours()}function hr(n,r){return En(n,r).getMinutes()}function pr(n,r){return En(n,r).getSeconds()}function dr(n,r){return En(n,r).getMilliseconds()}var gr={"%Y":[cr,4],"%m":[fr,2],"%d":[ar,2],"%H":[vr,2],"%M":[hr,2],"%S":[pr,2],"%L":[dr,3],"%j":[or,3],"%w":[sr,1],"%U":[lr,2],"%%":"%"};function yr(n,r){var t=En(n,r),e=t[0],u=t[1],i=t[2];return!S(e)||u<0?"":i<0?e.substr(u):e.substr(u,i)}var mr=[192,224,240];function $r(n){if(n<128)return[n];for(var r=(n<2048?1:n<65536&&2)||3,t=[(n>>6*r)+mr[r-1]];0<r;)t.push(128|n>>6*--r&63);return t}var _r=Object.freeze({__proto__:null,$abs:function(n,r){var t=En(n,r);return null==t?null:Math.abs(t)},$add:function(n,r){var t=En(n,r),e=!1,u=X(t,function(n,r){return r instanceof Date&&(A(!e,"'$add' can only have one date value"),e=!0,r=r.getTime()),n+=r},0);return e?new Date(u):u},$ceil:function(n,r){var t=En(n,r);return D(t)?null:(A(P(t)||isNaN(t),"$ceil expression must resolve to a number."),Math.ceil(t))},$divide:function(n,r){var t=En(n,r);return t[0]/t[1]},$exp:function(n,r){var t=En(n,r);return D(t)?null:(A(P(t)||isNaN(t),"$exp expression must resolve to a number."),Math.exp(t))},$floor:function(n,r){var t=En(n,r);return D(t)?null:(A(P(t)||isNaN(t),"$floor expression must resolve to a number."),Math.floor(t))},$ln:function(n,r){var t=En(n,r);return D(t)?null:(A(P(t)||isNaN(t),"$ln expression must resolve to a number."),Math.log(t))},$log:function(n,r){var t=En(n,r),e="$log expression must resolve to array(2) of numbers";return A(T(t)&&2===t.length,e),t.some(D)?null:(A(t.some(isNaN)||t.every(P),e),Math.log10(t[0])/Math.log10(t[1]))},$log10:function(n,r){var t=En(n,r);return D(t)?null:(A(P(t)||isNaN(t),"$log10 expression must resolve to a number."),Math.log10(t))},$mod:function(n,r){var t=En(n,r);return t[0]%t[1]},$multiply:function(n,r){return X(En(n,r),function(n,r){return n*r},1)},$pow:function(n,r){var t=En(n,r);return A(T(t)&&2===t.length&&t.every(P),"$pow expression must resolve to array(2) of numbers"),A(!(0===t[0]&&t[1]<0),"$pow cannot raise 0 to a negative exponent"),Math.pow(t[0],t[1])},$round:function(n,r){var t=En(n,r),e=t[0],u=t[1];return D(e)||isNaN(e)||Math.abs(e)===1/0?e:(A(P(e),"$round expression must resolve to a number."),Sn(e,u,!0))},$sqrt:function(n,r){var t=En(n,r);return D(t)?null:(A(P(t)&&0<t||isNaN(t),"$sqrt expression must resolve to non-negative number."),Math.sqrt(t))},$subtract:function(n,r){var t=En(n,r);return t[0]-t[1]},$trunc:function(n,r){var t=En(n,r),e=t[0],u=t[1];return D(e)||isNaN(e)||Math.abs(e)===1/0?e:(A(P(e),"$trunc expression must resolve to a number."),A(D(u)||P(u)&&-20<u&&u<100,"$trunc expression has invalid place"),Sn(e,u,!1))},$arrayElemAt:function(n,r){var t=En(n,r);A(T(t)&&2===t.length,"$arrayElemAt expression must resolve to array(2)"),A(T(t[0]),"First operand to $arrayElemAt must resolve to an array"),A(P(t[1]),"Second operand to $arrayElemAt must resolve to an integer");var e=t[1];return t=t[0],e<0&&Math.abs(e)<=t.length?t[e+t.length]:0<=e&&e<t.length?t[e]:void 0},$arrayToObject:function(n,r){var t=En(n,r);return A(T(t),"$arrayToObject expression must resolve to an array"),X(t,function(n,r){return T(r)&&2==r.length?n[r[0]]=r[1]:(A(I(r)&&V(r,"k")&&V(r,"v"),"$arrayToObject expression is invalid."),n[r.k]=r.v),n},{})},$concatArrays:function(n,r){var t=En(n,r,null);return A(T(t),"$concatArrays must resolve to an array"),t.some(D)?null:t.reduce(function(n,r){return cn(n,r)},[])},$filter:function(n,r){var t=En(n,r.input),e=r.as,u=r.cond;return A(T(t),"$filter 'input' expression must resolve to an array"),t.filter(function(n){var r={};return r["$"+e]=n,!0===En(r,u)})},$in:function(n,r){var t=En(n,r[0]),e=En(n,r[1]);return A(T(e),"$in second argument must be an array"),e.some(rn.bind(null,t))},$indexOfArray:function(n,r){var t=En(n,r);if(D(t))return null;var e=t[0],u=t[1];if(D(e))return null;A(T(e),"$indexOfArray expression must resolve to an array.");var i=t[2]||0,o=t[3];return D(o)&&(o=e.length),o<i?-1:(A(0<=i&&0<=o,"$indexOfArray expression is invalid"),(0<i||o<e.length)&&(e=e.slice(i,o)),e.findIndex(rn.bind(null,u))+i)},$isArray:function(n,r){return T(En(n,r[0]))},$map:function(r,n){var t=En(r,n.input);A(T(t),"$map 'input' expression must resolve to an array");var e=n.as,u=n.in,i="$"+e;return t.map(function(n){return r[i]=n,En(r,u)})},$objectToArray:function(n,r){var t=En(n,r);A(I(t),"$objectToArray expression must resolve to an object");var e=[];return G(t,function(n,r){return e.push({k:r,v:n})}),e},$range:function(n,r){for(var t=En(n,r),e=t[0],u=t[1],i=t[2]||1,o=[];e<u&&0<i||u<e&&i<0;)o.push(e),e+=i;return o},$reduce:function(n,r){var t=En(n,r.input),e=En(n,r.initialValue),u=r.in;return D(t)?null:(A(T(t),"$reduce 'input' expression must resolve to an array"),X(t,function(n,r){return En({$value:n,$this:r},u)},e))},$reverseArray:function(n,r){var t=En(n,r);if(D(t))return null;A(T(t),"$reverseArray expression must resolve to an array");var e=[];return cn(e,t),e.reverse(),e},$size:function(n,r){var t=En(n,r);return T(t)?t.length:void 0},$slice:function(n,r){var t=En(n,r);return _n(t[0],t[1],t[2])},$zip:function(n,r){var e=En(n,r.inputs),t=r.useLongestLength||!1;A(T(e),"'inputs' expression must resolve to an array"),A(N(t),"'useLongestLength' must be a boolean"),T(r.defaults)&&A(B(t),"'useLongestLength' must be set to true to use 'defaults'");for(var u=0,i=0,o=e.length;i<o;i++){var a=e[i];if(D(a))return null;A(T(a),"'inputs' expression values must resolve to an array or null"),u=t?Math.max(u,a.length):Math.min(u||a.length,a.length)}for(var s=[],c=r.defaults||[],f=function(t){var n=e.map(function(n,r){return D(n[t])?c[r]||null:n[t]});s.push(n)},l=0;l<u;l++)f(l);return s},$mergeObjects:function(n,r){var t=En(n,r);return T(t)?X(t,function(n,r){return Object.assign(n,r)},{}):{}},$and:function(n,r){var t=En(n,r);return B(t)&&t.every(B)},$or:function(n,r){var t=En(n,r);return B(t)&&t.some(B)},$not:function(n,r){return!En(n,r[0])},$eq:Zn,$ne:nr,$gt:rr,$lt:tr,$gte:er,$lte:ur,$nin:ir,$cmp:function(n,r){var t=En(n,r);return t[0]>t[1]?1:t[0]<t[1]?-1:0},$cond:function(n,r){var t,e,u,i="$cond: invalid arguments";u=r instanceof Array?(A(3===r.length,i),t=r[0],e=r[1],r[2]):(A(I(r),i),t=r.if,e=r.then,r.else);var o=En(n,t);return En(n,o?e:u)},$switch:function(r,n){var t="Invalid arguments for $switch operator";A(n.branches,t);var e=n.branches.find(function(n){return A(n.case&&n.then,t),En(r,n.case)});return e?En(r,e.then):(A(n.default,t),En(r,n.default))},$ifNull:function(n,r){A(T(r)&&2===r.length,"$ifNull expression must resolve to array(2)");var t=En(n,r);return D(t[0])?t[1]:t[0]},$dayOfYear:or,$dayOfMonth:ar,$dayOfWeek:sr,$year:cr,$month:fr,$week:lr,$hour:vr,$minute:hr,$second:pr,$millisecond:dr,$dateToString:function(n,r){for(var t,e,u=r.format,i=En(n,r.date),o=u.match(/(%%|%Y|%m|%d|%H|%M|%S|%L|%j|%w|%U)/g),a=0,s=o.length;a<s;a++){var c=gr[o[a]],f=c;if(T(c)){var l=c[0],v=c[1];t=l(n,i),e=v,f=new Array(Math.max(e-String(t).length+1,0)).join("0")+t}u=u.replace(o[a],f)}return u},$literal:function(n,r){return r},$setEquals:function(n,r){var t=En(n,r),e=tn(t[0]),u=tn(t[1]);return e.length===u.length&&e.length===Z(e,u).length},$setIntersection:function(n,r){var t=En(n,r);return Z(t[0],t[1])},$setDifference:function(n,r){var t=En(n,r);return t[0].filter(z.bind(null,t[1]))},$setUnion:function(n,r){var t,e,u=En(n,r);return t=u[0],e=u[1],cn(cn([],t),e.filter(z.bind(null,t)))},$setIsSubset:function(n,r){var t=En(n,r);return Z(t[0],t[1]).length===t[0].length},$anyElementTrue:function(n,r){return En(n,r)[0].some(B)},$allElementsTrue:function(n,r){return En(n,r)[0].every(B)},$concat:function(n,r){var t=En(n,r);return[null,void 0].some(U.bind(null,t))?null:t.join("")},$indexOfBytes:function(n,r){var t=En(n,r),e="$indexOfBytes expression resolves to invalid an argument";if(D(t[0]))return null;A(S(t[0])&&S(t[1]),e);var u=t[0],i=t[1],o=t[2],a=t[3],s=D(o)||P(o)&&0<=o&&Math.round(o)===o;if(A(s=s&&(D(a)||P(a)&&0<=a&&Math.round(a)===a),e),o=o||0,(a=a||u.length)<o)return-1;var c=u.substring(o,a).indexOf(i);return-1<c?c+o:c},$split:function(n,r){var t=En(n,r);return D(t[0])?null:(A(t.every(S),"$split expression must result to array(2) of strings"),t[0].split(t[1]))},$strLenBytes:function(n,r){return~-encodeURI(En(n,r)).split(/%..|./).length},$strLenCP:function(n,r){return En(n,r).length},$strcasecmp:function(n,r){var t=En(n,r),e=t[0],u=t[1];return rn(e,u)||t.every(D)?0:(A(t.every(S),"$strcasecmp must resolve to array(2) of strings"),e=e.toUpperCase(),((u=u.toUpperCase())<e?1:e<u&&-1)||0)},$substrBytes:function(n,r){var t=En(n,r),e=t[0],u=t[1],i=t[2];A(S(e)&&P(u)&&0<=u&&P(i)&&0<=i,"$substrBytes: invalid arguments");for(var o=function(n){for(var r=[],t=0,e=n.length;t<e;t++)r.push($r(n.codePointAt(t)));return r}(e),a=[],s=0,c=0;c<o.length;c++)a.push(s),s+=o[c].length;var f=a.indexOf(u),l=a.indexOf(u+i);return A(-1<f&&-1<l,"$substrBytes: invalid range, start or end index is a UTF-8 continuation byte."),e.substring(f,l)},$substr:yr,$substrCP:function(n,r){return yr(n,r)},$toLower:function(n,r){var t=En(n,r);return Y(t)?"":t.toLowerCase()},$toUpper:function(n,r){var t=En(n,r);return Y(t)?"":t.toUpperCase()},$let:function(t,n){var e=n.vars,r=n.in;return G(H(e),function(n){var r=En(t,e[n]);t["$"+n]=r}),En(t,r)}});function br(n,r){return D(r)?n:n.map(function(n){return En(n,r)})}var xr=Object.freeze({__proto__:null,$addToSet:function(n,r){return tn(br(n,r))},$avg:function(n,r){var t=br(n,r).filter(P);return X(t,function(n,r){return n+r},0)/(t.length||1)},$first:function(n,r){return 0<n.length?En(n[0],r):void 0},$last:function(n,r){return 0<n.length?En(n[n.length-1],r):void 0},$max:function(n,r){return X(br(n,r),function(n,r){return D(n)||n<r?r:n},void 0)},$mergeObjects:function(n,t){return X(n,function(n,r){return Object.assign(n,En(r,t))},{})},$min:function(n,r){return X(br(n,r),function(n,r){return D(n)||r<n?r:n},void 0)},$push:br,$stdDevPop:function(n,r){return bn(br(n,r).filter(P),!1)},$stdDevSamp:function(n,r){return bn(br(n,r).filter(P),!0)},$sum:function(n,r){return T(n)?P(r)?n.length*r:X(br(n,r).filter(P),function(n,r){return n+r},0):0}});function Or(n,u,r){var i=H(u);return 0===i.length?n:n.map(function(t){var e=w(t);return G(i,function(n){var r=En(t,u[n]);gn(e,n,r)}),e})}var kr=Or;function Ar(n,i,r){var o=wn(),t=i[o];return n.transform(function(n){var e=sn(n,function(n){return En(n,t,t)});delete(i=j(i))[o];var u=-1,r=e.keys.length;return function(){if(++u===r)return{done:!0};var n=e.keys[u],t={};return void 0!==n&&(t[o]=n),G(i,function(n,r){t[r]=Mn(e.groups[u],r,n)}),{value:t,done:!1}}})}function wr(n){var t=wn(),e=[!1,!1];G(n,function(n,r){r!==t&&(0===n||!1===n?e[0]=!0:1!==n&&!0!==n||(e[1]=!0),A(!(e[0]&&e[1]),"Projection cannot have a mix of inclusion and exclusion."))})}function jr(n,i,r){if(Y(i)||!I(i))return n;r=r||Object.create({});var o=on,t=r.collation;return I(t)&&S(t.locale)&&(o=function(n){var r={sensitivity:Mr[n.strength||3],caseFirst:"off"!==n.caseFirst&&n.caseFirst||"false",numeric:n.numericOrdering||!1,ignorePunctuation:"shifted"===n.alternate};!0===(n.caseLevel||!1)&&("base"===r.sensitivity&&(r.sensitivity="case"),"accent"===r.sensitivity&&(r.sensitivity="variant"));var e=new Intl.Collator(n.locale,r);return function(n,r){if(!S(n)||!S(r))return on(n,r);var t=e.compare(n,r);return t<0?-1:0<t?1:0}}(t)),n.transform(function(u){return G(H(i).reverse(),function(r){var t=sn(u,function(n){return vn(n,r)}),e={},n=an(t.keys,function(n,r){return e[n]=r,n},o);-1===i[r]&&n.reverse(),u=[],G(n,function(n){return cn(u,t.groups[e[n]])})}),u})}var Mr={1:"base",2:"accent",3:"variant"};var Er=Object.freeze({__proto__:null,$addFields:Or,$set:kr,$bucket:function(n,u,r){var i=u.boundaries,o=u.default,a=i[0],s=i[i.length-1],t=u.output||{count:{$sum:1}};A(2<i.length,"$bucket 'boundaries' expression must have at least 3 elements");for(var e=M(a),c=0,f=i.length-1;c<f;c++)A(e===M(i[c+1]),"$bucket 'boundaries' must all be of the same type"),A(i[c]<i[c+1],"$bucket 'boundaries' must be sorted in ascending order");D(o)||M(u.default)!==M(a)||A(a>u.default||s<u.default,"$bucket 'default' expression must be out of boundaries range");var l={};G(i,function(n){return l[n]=[]}),D(o)||(l[o]=[]);var v=!1;return Pn(function(){return v instanceof Cn||(n.each(function(n){var r=En(n,u.groupBy);if(D(r)||r<a||s<=r)A(!D(o),"$bucket require a default for out of range values"),l[o].push(n);else{A(a<=r&&r<s,"$bucket 'groupBy' expression must resolve to a value in range of boundaries");var t=function(n,r){for(var t=0,e=n.length-1;t<=e;){var u=Math.round(t+(e-t)/2);if(r<n[u])e=u-1;else{if(!(r>n[u]))return u;t=u+1}}return t}(i,r),e=i[Math.max(0,t-1)];l[e].push(n)}}),i.pop(),D(o)||i.push(o),v=Pn(i).map(function(n){var r=Mn(l[n],null,t);return Object.assign(r,{_id:n})})),v.next()})},$bucketAuto:function(n,r,t){var d=r.output||{count:{$sum:1}},g=r.groupBy,y=r.buckets;return A(0<y,"The $bucketAuto 'buckets' field must be greater than 0, but found: "+y),n.transform(function(n){for(var r=Math.max(1,Math.round(n.length/y)),t=fn(En),e={},u=[],i=an(n,function(n){var r=t(n,g);return D(r)?u.push(n):(e[r]||(e[r]=[]),e[r].push(n)),r}),o=wn(),a=[],s=0,c=0,f=i.length;c<y&&s<f;c++){for(var l=Object.create({min:0,max:0}),v=new Array,h=0;h<r&&s<f;h++){var p=t(i[s],g);if(D(p)&&(p=null),cn(v,D(p)?u:e[p]),s+=D(p)?u.length:e[p].length,V(l,"min")||(l.min=p),0<a.length)a[a.length-1][o].max=l.min}c==y-1&&cn(v,i.slice(s)),a.push(Object.assign(Mn(v,null,d),{_id:l}))}return 0<a.length&&(a[a.length-1][o].max=t(i[i.length-1],g)),a})},$count:function(r,t,n){return A(S(t)&&""!==t.trim()&&-1===t.indexOf(".")&&"$"!==t.trim()[0],"Invalid expression value for $count"),Pn(function(){var n={};return n[t]=r.size(),{value:n,done:!1}}).first()},$facet:function(n,t,r){return n.transform(function(r){return[Q(t,function(n){return Ln(r,n)})]})},$group:Ar,$limit:function(n,r,t){return n.take(r)},$lookup:function(n,r,t){var e=r.from,u=r.localField,i=r.foreignField,o=r.as;A(T(e)&&S(i)&&S(u)&&S(o),"$lookup: invalid argument");var a={};return G(e,function(n){var r=un(vn(n,i));a[r]=a[r]||[],a[r].push(n)}),n.map(function(n){var r=un(vn(n,u)),t=j(n);return t[o]=a[r]||[],t})},$match:function(n,r,t){var e=new Un(r);return n.filter(function(n){return e.test(n)})},$out:function(n,r,t){return A(T(r),"$out expression must be an array"),n.map(function(n){return r.push(n),n})},$project:function(n,r,t){if(Y(r))return n;var e=H(r),u=!1,i=wn();if(wr(r),U(e,i)){var o=r[i];0!==o&&!1!==o||(e=e.filter(z.bind(null,[i])),A(z(e,i),"Must not contain collections id key"),u=Y(e))}else e.push(i);return n.map(function(n){return function s(c,f,n,r){var l=wn();var v=new Object;var h=!1;var p=!1;var d=[];r&&d.push(l);n.forEach(function(n){var r=void 0,t=f[n];if(n!==l&&U([0,!1],t)&&(p=!0),n===l&&Y(t))r=c[n];else if(S(t))r=En(c,t,n);else if(!U([1,!0],t))if(Array.isArray(t))r=t.map(function(n){var r=En(c,n);return D(r)?null:r});else{if(!I(t))return void d.push(n);var e=H(t),u=1<e.length?"":e[0];if(V(Gr[b],u)){var i=Gr[b];"$slice"===u?J(t[u]).every(P)?(r=i[u](c,t[u],n),h=!0):r=En(c,t,n):r=i[u](c,t[u],n)}else if(V(c,n)){wr(t);var o=c[n];r=Array.isArray(o)?o.map(function(n){return s(n,t,e,!1)}):s(o,t,e,!1)}else r=En(c,t,n)}var a=hn(c,n,{preserveMissingValues:!0});void 0!==a&&W(v,a,{flatten:!0}),z([0,1,!1,!0],t)&&(void 0===r?yn(v,n):gn(v,n,r))});pn(v);(h||p||r)&&(v=Object.assign({},c,v),0<d.length&&(v=w(v),G(d,function(n){return yn(v,n)})));return v}(n,r,e,u)})},$redact:function(n,r,t){return n.map(function(n){return Nn(w(n),r)})},$replaceRoot:function(n,r,t){return n.map(function(n){return A(I(n=En(n,r.newRoot)),"$replaceRoot expression must return an object"),n})},$sample:function(n,r,t){var u=r.size;return A(P(u),"$sample size must be a positive integer"),n.transform(function(r){var t=r.length,e=-1;return function(){if(++e===u)return{done:!0};var n=Math.floor(Math.random()*t);return{value:r[n],done:!1}}})},$skip:function(n,r,t){return n.drop(r)},$sort:jr,$sortByCount:function(n,r,t){var e={count:{$sum:1}};return e[wn()]=r,jr(Ar(n,e),{count:-1},t)},$unwind:function(u,n,r){function i(n,r){return!1!==t&&(n[t]=r),n}S(n)&&(n={path:n});var o,a=n.path.substr(1),t=n.includeArrayIndex||!1,s=n.preserveNullAndEmptyArrays||!1;return Pn(function(){for(var n=function(){if(o instanceof Cn){var n=o.next();if(!n.done)return{v:n}}var e=u.next();if(e.done)return{v:e};if(e=e.value,o=vn(e,a),T(o)){if(0===o.length&&!0===s){o=null;var r=w(e);return yn(r,a),{v:{value:i(r,null),done:!1}}}o=Pn(o).map(function(n,r){var t=w(e);return gn(t,a,n),i(t,r)})}else if(!Y(o)||!0===s){var t=w(e);return{v:{value:i(t,null),done:!1}}}};;){var r=n();if("object"===c(r))return r.v}})}});var Nr=Object.freeze({__proto__:null,$:function(n,r,t){K("$ not implemented")},$elemMatch:function(n,r,t){var e=vn(n,t),u=new Un(r);A(Array.isArray(e),"$elemMatch: invalid argument");for(var i=0;i<e.length;i++)if(u.test(e[i]))return[e[i]]},$slice:function(n,r,t){var e=vn(n,t);return Array.isArray(e)?Array.isArray(r)?_n(e,r[0],r[1]):(A(P(r),"$slice: invalid arguments for projection"),_n(e,r)):e}});function Sr(u){return function(t,e){return function(n){var r=vn(n,t,{preserveMetadata:!0});return r=function(n,r){if(r<1)return n;for(;r--&&T(n)&&1===n.length;)n=n[0];return n}(r.result,r.depth),u(r,e)}}}var Pr=Sr(function(n,r){var t=!1;if(n instanceof Array&&r instanceof Array)for(var e=0,u=r.length;e<u;e++){if(!I(r[e])||!U(H(r[e]),"$elemMatch"))return Z(r,n).length===u;t=t||Qn(n,r[e].$elemMatch)}return t}),Tr=Sr(Qn),Ir=Sr(zn),Rr=Sr(function(n,r){return(!1===r||0===r)&&void 0===n||(!0===r||1===r)&&void 0!==n}),Fr=Sr(Hn),Cr=Sr(Gn),Dr=Sr(Yn),Lr=Sr(Vn),qr=Sr(Kn),Ur=Sr(function(n,r){return J(n).some(function(n){return 2===r.length&&n%r[0]===r[1]})}),zr=Sr(Bn),Br=Sr(Jn),Yr=Sr(function(n,r){function t(n){return S(n)&&!!n.match(r)}return(n=J(n)).some(t)||nn(n,1).some(t)}),Jr=Sr(function(n,r){return n.length===r}),Vr=Sr(function(n,r){switch(r){case 1:case"double":return P(n)&&-1!==(n+"").indexOf(".");case 2:case l:return S(n);case 3:case d:return I(n);case 4:case p:return T(n);case 6:case o:return D(n);case 8:case"bool":return N(n);case 9:case v:return t(n);case 10:case i:return L(n);case 11:case"regex":return F(n);case 16:case"int":return P(n)&&n<=2147483647&&-1===(n+"").indexOf(".");case 18:case"long":return P(n)&&2147483647<n&&n<=0x8000000000000000&&-1===(n+"").indexOf(".");case 19:case"decimal":return P(n);default:return!1}});function Kr(n,r){A(T(r),"Invalid expression. $or expects value to be an Array");var t=[];return G(r,function(n){return t.push(new Un(n))}),function(n){for(var r=0;r<t.length;r++)if(t[r].test(n))return!0;return!1}}var Hr=Object.freeze({__proto__:null,$all:Pr,$elemMatch:Tr,$eq:Ir,$exists:Rr,$gt:Fr,$gte:Cr,$in:Dr,$lt:Lr,$lte:qr,$mod:Ur,$ne:zr,$nin:Br,$regex:Yr,$size:Jr,$type:Vr,$and:function(n,r){A(T(r),"Invalid expression: $and expects value to be an Array");var t=[];return G(r,function(n){return t.push(new Un(n))}),function(n){for(var r=0;r<t.length;r++)if(!t[r].test(n))return!1;return!0}},$or:Kr,$nor:function(n,r){A(T(r),"Invalid expression. $nor expects value to be an Array");var t=Kr(0,r);return function(n){return!t(n)}},$not:function(n,r){var t={};t[n]=$n(r);var e=new Un(t);return function(n){return!e.test(n)}},$where:function(n,r){var t;return t=C(r)?r:new Function("return "+r+";"),function(n){return!0===t.call(n)}},$expr:function(n,r){return function(n){return En(n,r)}}}),Gr={};Gr[m]={},Gr[$]={},Gr[_]={},Gr[b]={},Gr[x]={};var Qr={query:function(n,r){return new Un(n).find(this.toJSON(),r)},aggregate:function(n){return new Dn(n).run(this.toJSON())}};G([[m,_r],[$,xr],[_,Er],[b,Nr],[x,Hr]],function(n){var r=u(n,2),t=r[0],e=r[1];Object.assign(Gr[t],e)}),n.Aggregator=Dn,n.CollectionMixin=Qr,n.Cursor=qn,n.Lazy=Pn,n.OP_EXPRESSION=m,n.OP_GROUP=$,n.OP_PIPELINE=_,n.OP_PROJECTION=b,n.OP_QUERY=x,n.Query=Un,n._internal=xn,n.addOperators=function(t,n){var a=n(xn());A(V(Gr,t),"Invalid operator class ".concat(t));var e=Gr[t];G(a,function(n,r){A(/^\$[a-zA-Z0-9_]*$/.test(r),"Invalid operator name ".concat(r)),A(!V(e,r),"".concat(r," already exists for '").concat(t,"' operators"))});var r={};switch(t){case x:G(a,function(i,o){i=i.bind(a),r[o]=function(e,u){return function(n){var r=vn(n,e),t=i(e,r,u);return A(N(t),"".concat(o," must return a boolean")),t}}});break;case b:G(a,function(u,n){u=u.bind(a),r[n]=function(n,r,t){var e=vn(n,t);return u(t,e,r)}});break;default:G(a,function(e,n){r[n]=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];return e.apply(a,r)}})}Object.assign(Gr[t],r)},n.aggregate=Ln,n.find=function(n,r,t){return new Un(r).find(n,t)},n.remove=function(n,r){return new Un(r).remove(n)},n.setup=function(n){Object.assign(On,n)},Object.defineProperty(n,"__esModule",{value:!0})});